{"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.19.3:development":{"value":{"code":"import express from \"express\";\nimport config from \"./config\";\nconsole.log(config.port);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwiY29uZmlnIiwiY29uc29sZSIsImxvZyIsInBvcnQiXSwic291cmNlUm9vdCI6Ii9ob21lL2MwNy1hZG1pbmlzdHJhZG9yL2pzL29yYWNsZS9iYWNrZW5kcy9pZHJ1cy8iLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xuaW1wb3J0IGNvbmZpZyBmcm9tIFwiLi9jb25maWdcIjtcblxuXG5cbmNvbnNvbGUubG9nIChjb25maWcucG9ydCk7XG5cbiJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBT0EsT0FBTyxNQUFNLFNBQVM7QUFDN0IsT0FBT0MsTUFBTSxNQUFNLFVBQVU7QUFJN0JDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFFRixNQUFNLENBQUNHLElBQUksQ0FBQyJ9","map":{"version":3,"names":["express","config","console","log","port"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/","sources":["server.js"],"sourcesContent":["import express from \"express\";\nimport config from \"./config\";\n\n\n\nconsole.log (config.port);\n\n"],"mappings":"AAAA,OAAOA,OAAO,MAAM,SAAS;AAC7B,OAAOC,MAAM,MAAM,UAAU;AAI7BC,OAAO,CAACC,GAAG,CAAEF,MAAM,CAACG,IAAI,CAAC"}},"mtime":1665993427634},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _citas = _interopRequireDefault(require(\"./routes/citas.routes\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst bodyParser = require('body-parser');\nconst cors = require(\"cors\");\nconst logger = require('morgan');\nconst app = (0, _express.default)();\napp.use(bodyParser.urlencoded({\n  extended: false\n}));\napp.use(bodyParser.json());\napp.use(logger('combined'));\napp.use(function (req, res, next) {\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\n  res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n  res.header('Access-Control-Allow-Methods', 'PUT, POST, GET, DELETE, OPTIONS');\n  next();\n});\nlet port = process.env.PORT;\napp.use(_citas.default);\napp.use(cors);\napp.set(\"port\", port);\nvar _default = app;\nexports.default = _default;\napp.listen(process.env.PORT);\nconsole.log(\"Server listening on port \" + port);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJib2R5UGFyc2VyIiwicmVxdWlyZSIsImNvcnMiLCJsb2dnZXIiLCJhcHAiLCJleHByZXNzIiwidXNlIiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwianNvbiIsInJlcSIsInJlcyIsIm5leHQiLCJoZWFkZXIiLCJwb3J0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJjaXRhc1JvdXRlciIsInNldCIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciXSwic291cmNlUm9vdCI6Ii9ob21lL2MwNy1hZG1pbmlzdHJhZG9yL2pzL29yYWNsZS9iYWNrZW5kcy9pZHJ1cy8iLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XG5cbmltcG9ydCBjaXRhc1JvdXRlciBmcm9tIFwiLi9yb3V0ZXMvY2l0YXMucm91dGVzXCJcblxuXG5jb25zdCBib2R5UGFyc2VyPXJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XG5jb25zdCBjb3JzID0gcmVxdWlyZShcImNvcnNcIilcbmNvbnN0IGxvZ2dlcj1yZXF1aXJlKCdtb3JnYW4nKTtcblxuY29uc3QgYXBwID0gZXhwcmVzcyAoKTtcbmFwcC51c2UoYm9keVBhcnNlci51cmxlbmNvZGVkKHtleHRlbmRlZDpmYWxzZX0pKTtcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKCkpO1xuYXBwLnVzZShsb2dnZXIoJ2NvbWJpbmVkJykpO1xuXG5hcHAudXNlKGZ1bmN0aW9uIChyZXEsIHJlcywgbmV4dCkge1xuXHRyZXMuaGVhZGVyKFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luXCIsIFwiKlwiKTtcblx0cmVzLmhlYWRlcihcblx0XHRcIkFjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnNcIixcblx0XHRcIk9yaWdpbiwgWC1SZXF1ZXN0ZWQtV2l0aCwgQ29udGVudC1UeXBlLCBBY2NlcHRcIlxuXHQpO1xuXHRyZXMuaGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJywgJ1BVVCwgUE9TVCwgR0VULCBERUxFVEUsIE9QVElPTlMnKTtcblx0bmV4dCgpO1xufSk7XG5cbmxldCBwb3J0ID0gcHJvY2Vzcy5lbnYuUE9SVDtcbmFwcC51c2UoY2l0YXNSb3V0ZXIpO1xuYXBwLnVzZShjb3JzKTtcbmFwcC5zZXQoXCJwb3J0XCIscG9ydCk7XG5cbmV4cG9ydCBkZWZhdWx0IGFwcDtcblxuYXBwLmxpc3Rlbihwcm9jZXNzLmVudi5QT1JUKTtcblxuY29uc29sZS5sb2cgKFwiU2VydmVyIGxpc3RlbmluZyBvbiBwb3J0IFwiICsgcG9ydCk7XG5cblxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQTtBQUVBO0FBQStDO0FBRy9DLE1BQU1BLFVBQVUsR0FBQ0MsT0FBTyxDQUFDLGFBQWEsQ0FBQztBQUN2QyxNQUFNQyxJQUFJLEdBQUdELE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDNUIsTUFBTUUsTUFBTSxHQUFDRixPQUFPLENBQUMsUUFBUSxDQUFDO0FBRTlCLE1BQU1HLEdBQUcsR0FBRyxJQUFBQyxnQkFBTyxHQUFHO0FBQ3RCRCxHQUFHLENBQUNFLEdBQUcsQ0FBQ04sVUFBVSxDQUFDTyxVQUFVLENBQUM7RUFBQ0MsUUFBUSxFQUFDO0FBQUssQ0FBQyxDQUFDLENBQUM7QUFDaERKLEdBQUcsQ0FBQ0UsR0FBRyxDQUFDTixVQUFVLENBQUNTLElBQUksRUFBRSxDQUFDO0FBQzFCTCxHQUFHLENBQUNFLEdBQUcsQ0FBQ0gsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBRTNCQyxHQUFHLENBQUNFLEdBQUcsQ0FBQyxVQUFVSSxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxFQUFFO0VBQ2pDRCxHQUFHLENBQUNFLE1BQU0sQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLENBQUM7RUFDOUNGLEdBQUcsQ0FBQ0UsTUFBTSxDQUNULDhCQUE4QixFQUM5QixnREFBZ0QsQ0FDaEQ7RUFDREYsR0FBRyxDQUFDRSxNQUFNLENBQUMsOEJBQThCLEVBQUUsaUNBQWlDLENBQUM7RUFDN0VELElBQUksRUFBRTtBQUNQLENBQUMsQ0FBQztBQUVGLElBQUlFLElBQUksR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNDLElBQUk7QUFDM0JiLEdBQUcsQ0FBQ0UsR0FBRyxDQUFDWSxjQUFXLENBQUM7QUFDcEJkLEdBQUcsQ0FBQ0UsR0FBRyxDQUFDSixJQUFJLENBQUM7QUFDYkUsR0FBRyxDQUFDZSxHQUFHLENBQUMsTUFBTSxFQUFDTCxJQUFJLENBQUM7QUFBQyxlQUVOVixHQUFHO0FBQUE7QUFFbEJBLEdBQUcsQ0FBQ2dCLE1BQU0sQ0FBQ0wsT0FBTyxDQUFDQyxHQUFHLENBQUNDLElBQUksQ0FBQztBQUU1QkksT0FBTyxDQUFDQyxHQUFHLENBQUUsMkJBQTJCLEdBQUdSLElBQUksQ0FBQyJ9","map":{"version":3,"names":["bodyParser","require","cors","logger","app","express","use","urlencoded","extended","json","req","res","next","header","port","process","env","PORT","citasRouter","set","listen","console","log"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/","sources":["server.js"],"sourcesContent":["\nimport express from \"express\";\n\nimport citasRouter from \"./routes/citas.routes\"\n\n\nconst bodyParser=require('body-parser');\nconst cors = require(\"cors\")\nconst logger=require('morgan');\n\nconst app = express ();\napp.use(bodyParser.urlencoded({extended:false}));\napp.use(bodyParser.json());\napp.use(logger('combined'));\n\napp.use(function (req, res, next) {\n\tres.header(\"Access-Control-Allow-Origin\", \"*\");\n\tres.header(\n\t\t\"Access-Control-Allow-Headers\",\n\t\t\"Origin, X-Requested-With, Content-Type, Accept\"\n\t);\n\tres.header('Access-Control-Allow-Methods', 'PUT, POST, GET, DELETE, OPTIONS');\n\tnext();\n});\n\nlet port = process.env.PORT;\napp.use(citasRouter);\napp.use(cors);\napp.set(\"port\",port);\n\nexport default app;\n\napp.listen(process.env.PORT);\n\nconsole.log (\"Server listening on port \" + port);\n\n\n"],"mappings":";;;;;;AACA;AAEA;AAA+C;AAG/C,MAAMA,UAAU,GAACC,OAAO,CAAC,aAAa,CAAC;AACvC,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAME,MAAM,GAACF,OAAO,CAAC,QAAQ,CAAC;AAE9B,MAAMG,GAAG,GAAG,IAAAC,gBAAO,GAAG;AACtBD,GAAG,CAACE,GAAG,CAACN,UAAU,CAACO,UAAU,CAAC;EAACC,QAAQ,EAAC;AAAK,CAAC,CAAC,CAAC;AAChDJ,GAAG,CAACE,GAAG,CAACN,UAAU,CAACS,IAAI,EAAE,CAAC;AAC1BL,GAAG,CAACE,GAAG,CAACH,MAAM,CAAC,UAAU,CAAC,CAAC;AAE3BC,GAAG,CAACE,GAAG,CAAC,UAAUI,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACjCD,GAAG,CAACE,MAAM,CAAC,6BAA6B,EAAE,GAAG,CAAC;EAC9CF,GAAG,CAACE,MAAM,CACT,8BAA8B,EAC9B,gDAAgD,CAChD;EACDF,GAAG,CAACE,MAAM,CAAC,8BAA8B,EAAE,iCAAiC,CAAC;EAC7ED,IAAI,EAAE;AACP,CAAC,CAAC;AAEF,IAAIE,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,IAAI;AAC3Bb,GAAG,CAACE,GAAG,CAACY,cAAW,CAAC;AACpBd,GAAG,CAACE,GAAG,CAACJ,IAAI,CAAC;AACbE,GAAG,CAACe,GAAG,CAAC,MAAM,EAACL,IAAI,CAAC;AAAC,eAENV,GAAG;AAAA;AAElBA,GAAG,CAACgB,MAAM,CAACL,OAAO,CAACC,GAAG,CAACC,IAAI,CAAC;AAE5BI,OAAO,CAACC,GAAG,CAAE,2BAA2B,GAAGR,IAAI,CAAC"}},"mtime":1666005628696},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _dotenv = require(\"dotenv\");\n(0, _dotenv.config)();\nvar _default = {\n  port: process.env.PORT\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb25maWciLCJwb3J0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiXSwic291cmNlUm9vdCI6Ii9ob21lL2MwNy1hZG1pbmlzdHJhZG9yL2pzL29yYWNsZS9iYWNrZW5kcy9pZHJ1cy8iLCJzb3VyY2VzIjpbImNvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2NvbmZpZ30gZnJvbSBcImRvdGVudlwiO1xuXG5jb25maWcoKTtcblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIHBvcnQ6IHByb2Nlc3MuZW52LlBPUlRcbiAgICBcblxufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFFQSxJQUFBQSxjQUFNLEdBQUU7QUFBQyxlQUVNO0VBQ1hDLElBQUksRUFBRUMsT0FBTyxDQUFDQyxHQUFHLENBQUNDO0FBR3RCLENBQUM7QUFBQSJ9","map":{"version":3,"names":["config","port","process","env","PORT"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/","sources":["config.js"],"sourcesContent":["import {config} from \"dotenv\";\n\nconfig();\n\nexport default {\n    port: process.env.PORT\n    \n\n}"],"mappings":";;;;;;AAAA;AAEA,IAAAA,cAAM,GAAE;AAAC,eAEM;EACXC,IAAI,EAAEC,OAAO,CAACC,GAAG,CAACC;AAGtB,CAAC;AAAA"}},"mtime":1665997615203},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/citas.routes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _auth = _interopRequireDefault(require(\"./auth\"));\nvar _citas = require(\"../controllers/citas.controller\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nvar express = require('express');\nconst router = express.Router();\nconsole.log('Entra 1');\nrouter.get('/api/citas', _citas.getCitas);\nrouter.get('/api/camas', _citas.getCamas);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImNvbnNvbGUiLCJsb2ciLCJnZXQiLCJnZXRDaXRhcyIsImdldENhbWFzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9jMDctYWRtaW5pc3RyYWRvci9qcy9vcmFjbGUvYmFja2VuZHMvaWRydXMvcm91dGVzLyIsInNvdXJjZXMiOlsiY2l0YXMucm91dGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IGF1dGggZnJvbSBcIi4vYXV0aFwiO1xuXG5pbXBvcnQge2dldENpdGFzLCBnZXRDYW1hc30gZnJvbSAnLi4vY29udHJvbGxlcnMvY2l0YXMuY29udHJvbGxlcidcblxudmFyIGV4cHJlc3MgPSByZXF1aXJlICgnZXhwcmVzcycpO1xuXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG5jb25zb2xlLmxvZygnRW50cmEgMScpXG5cbnJvdXRlci5nZXQoJy9hcGkvY2l0YXMnLCAgZ2V0Q2l0YXMpO1xucm91dGVyLmdldCgnL2FwaS9jYW1hcycsICBnZXRDYW1hcyk7XG5cblxuZXhwb3J0IGRlZmF1bHQgcm91dGVyO1xuXG5cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0E7QUFFQTtBQUFrRTtBQUVsRSxJQUFJQSxPQUFPLEdBQUdDLE9BQU8sQ0FBRSxTQUFTLENBQUM7QUFFakMsTUFBTUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQU0sRUFBRTtBQUUvQkMsT0FBTyxDQUFDQyxHQUFHLENBQUMsU0FBUyxDQUFDO0FBRXRCSCxNQUFNLENBQUNJLEdBQUcsQ0FBQyxZQUFZLEVBQUdDLGVBQVEsQ0FBQztBQUNuQ0wsTUFBTSxDQUFDSSxHQUFHLENBQUMsWUFBWSxFQUFHRSxlQUFRLENBQUM7QUFBQyxlQUdyQk4sTUFBTTtBQUFBIn0=","map":{"version":3,"names":["express","require","router","Router","console","log","get","getCitas","getCamas"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/routes/","sources":["citas.routes.js"],"sourcesContent":["\nimport auth from \"./auth\";\n\nimport {getCitas, getCamas} from '../controllers/citas.controller'\n\nvar express = require ('express');\n\nconst router = express.Router();\n\nconsole.log('Entra 1')\n\nrouter.get('/api/citas',  getCitas);\nrouter.get('/api/camas',  getCamas);\n\n\nexport default router;\n\n\n"],"mappings":";;;;;;AACA;AAEA;AAAkE;AAElE,IAAIA,OAAO,GAAGC,OAAO,CAAE,SAAS,CAAC;AAEjC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,EAAE;AAE/BC,OAAO,CAACC,GAAG,CAAC,SAAS,CAAC;AAEtBH,MAAM,CAACI,GAAG,CAAC,YAAY,EAAGC,eAAQ,CAAC;AACnCL,MAAM,CAACI,GAAG,CAAC,YAAY,EAAGE,eAAQ,CAAC;AAAC,eAGrBN,MAAM;AAAA"}},"mtime":1666005310072},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/encuestas.routes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIvaG9tZS9jMDctYWRtaW5pc3RyYWRvci9qcy9vcmFjbGUvYmFja2VuZHMvaWRydXMvcm91dGVzLyIsInNvdXJjZXMiOlsiZW5jdWVzdGFzLnJvdXRlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIiXSwibWFwcGluZ3MiOiIifQ==","map":{"version":3,"names":[],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/routes/","sources":["encuestas.routes.js"],"sourcesContent":[""],"mappings":""}},"mtime":1665996228974},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/controllers/citas.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCitasCEX = void 0;\nvar _oracledb = _interopRequireDefault(require(\"oracledb\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nvar oracle = require('../database/connection.js');\nfunction fechaValida(fecha) {\n  if (fecha.length !== 8) {\n    return false;\n  }\n  const eje = fecha.substr(0, 4);\n  const mes = fecha.substr(4, 2);\n  const dia = fecha.substr(6, 2);\n  console.log(dia + '/' + mes + '/' + eje);\n  var date = (0, _moment.default)(fecha, 'YYYYMMDD');\n  if (date.isValid()) return true;\n  return false;\n}\nconst getCitasCEX = async (req, res, next) => {\n  //Validar fecha \n\n  var fecha = req.query.fecha;\n  if (fecha === undefined || !fechaValida(fecha)) {\n    res.writeHead(500, {\n      'Content-Type': 'application/json'\n    });\n    res.end(JSON.stringify({\n      status: 500,\n      message: \"Fecha Erronea\",\n      detailed_message: \"Introduzca una fecha válida (YYYYMMDD)\"\n    }));\n  } else {\n    const eje = fecha.substr(0, 4);\n    const mes = fecha.substr(4, 2);\n    const dia = fecha.substr(6, 2);\n    const fechacita = dia + '/' + mes + '/' + eje;\n    var fechacitamasuno;\n    var d = new Date(eje + '-' + mes + '-' + dia);\n    d.setDate(d.getDate() + 1);\n    fechacitamasuno = ('0' + d.getDate()).slice(-2) + '/' + ('0' + (d.getMonth() + 1)).slice(-2) + '/' + d.getFullYear();\n    const pool = await oracle.getConnection();\n    pool.execute(\"SELECT * FROM V07_Idrus_cex_dias WHERE fecha_cita > to_date(:fechacita,'DD/MM/YYYY') AND fecha_cita < to_date(:fechacitamasuno,'DD/MM/YYYY')\", [fechacita, fechacitamasuno], {\n      outFormat: _oracledb.default.OBJECT\n    }, function (err, result) {\n      if (err) {\n        console.log('Error el ejecutar la query:' + err.message);\n        res.writeHead(500, {\n          'Content-Type': 'application/json'\n        });\n        res.end(JSON.stringify({\n          status: 500,\n          message: \"Error private things\",\n          detailed_message: err.message\n        }));\n      } else {\n        res.writeHead(200, {\n          'Content-Type': 'application/json'\n        });\n        res.end(JSON.stringify(result.rows));\n      }\n    });\n  }\n};\nexports.getCitasCEX = getCitasCEX;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcmFjbGUiLCJyZXF1aXJlIiwiZmVjaGFWYWxpZGEiLCJmZWNoYSIsImxlbmd0aCIsImVqZSIsInN1YnN0ciIsIm1lcyIsImRpYSIsImNvbnNvbGUiLCJsb2ciLCJkYXRlIiwibW9tZW50IiwiaXNWYWxpZCIsImdldENpdGFzQ0VYIiwicmVxIiwicmVzIiwibmV4dCIsInF1ZXJ5IiwidW5kZWZpbmVkIiwid3JpdGVIZWFkIiwiZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsInN0YXR1cyIsIm1lc3NhZ2UiLCJkZXRhaWxlZF9tZXNzYWdlIiwiZmVjaGFjaXRhIiwiZmVjaGFjaXRhbWFzdW5vIiwiZCIsIkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsInNsaWNlIiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsInBvb2wiLCJnZXRDb25uZWN0aW9uIiwiZXhlY3V0ZSIsIm91dEZvcm1hdCIsIm9yYWNsZWRiIiwiT0JKRUNUIiwiZXJyIiwicmVzdWx0Iiwicm93cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYzA3LWFkbWluaXN0cmFkb3IvanMvb3JhY2xlL2JhY2tlbmRzL2lkcnVzL2NvbnRyb2xsZXJzLyIsInNvdXJjZXMiOlsiY2l0YXMuY29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgb3JhY2xlZGIgZnJvbSAnb3JhY2xlZGInO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuXG52YXIgb3JhY2xlID0gIHJlcXVpcmUoJy4uL2RhdGFiYXNlL2Nvbm5lY3Rpb24uanMnKVxuXG5mdW5jdGlvbiBmZWNoYVZhbGlkYShmZWNoYSkge1xuXG4gICAgaWYoZmVjaGEubGVuZ3RoICE9PSA4KSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICBjb25zdCBlamUgPSBmZWNoYS5zdWJzdHIoMCw0KTtcbiAgICBjb25zdCBtZXMgPSBmZWNoYS5zdWJzdHIoNCwyKTtcbiAgICBjb25zdCBkaWEgPSBmZWNoYS5zdWJzdHIoNiwyKTtcblxuICAgIGNvbnNvbGUubG9nKGRpYSArICcvJyArIG1lcyArICcvJyArIGVqZSlcblxuICAgIHZhciBkYXRlID0gbW9tZW50KGZlY2hhLCdZWVlZTU1ERCcpO1xuICAgIFxuICAgIGlmIChkYXRlLmlzVmFsaWQoKSkgcmV0dXJuIHRydWU7XG5cbiAgICByZXR1cm4gZmFsc2U7XG5cbn1cblxuZXhwb3J0IGNvbnN0IGdldENpdGFzQ0VYID0gYXN5bmMocmVxLCByZXMsIG5leHQpID0+e1xuICAgXG4gICAgLy9WYWxpZGFyIGZlY2hhIFxuIFxuICAgIHZhciBmZWNoYSA9IHJlcS5xdWVyeS5mZWNoYTtcbiAgXG5cbiAgICBpZiAoZmVjaGEgPT09dW5kZWZpbmVkIHx8ICFmZWNoYVZhbGlkYShmZWNoYSkpIHtcbiAgICAgICAgcmVzLndyaXRlSGVhZCg1MDAsIHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSk7XG4gICAgICAgICAgICByZXMuZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6NTAwLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6XCJGZWNoYSBFcnJvbmVhXCIsXG4gICAgICAgICAgICAgICAgZGV0YWlsZWRfbWVzc2FnZTogXCJJbnRyb2R1emNhIHVuYSBmZWNoYSB2w6FsaWRhIChZWVlZTU1ERClcIlxuICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICB9IGVsc2Uge1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZWplID0gZmVjaGEuc3Vic3RyKDAsNCk7XG4gICAgICAgIGNvbnN0IG1lcyA9IGZlY2hhLnN1YnN0cig0LDIpO1xuICAgICAgICBjb25zdCBkaWEgPSBmZWNoYS5zdWJzdHIoNiwyKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZlY2hhY2l0YSA9IGRpYSArICcvJyArIG1lcyArICcvJyArIGVqZTtcbiAgICAgICAgdmFyIGZlY2hhY2l0YW1hc3VubztcblxuICAgIFxuICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKGVqZSArICctJyArIG1lcyArICctJyArIGRpYSlcbiAgICAgICAgZC5zZXREYXRlKGQuZ2V0RGF0ZSgpICsgMSlcbiAgICAgICAgZmVjaGFjaXRhbWFzdW5vID0gKCcwJyArIGQuZ2V0RGF0ZSgpKS5zbGljZSgtMikgKyAnLycgKyAgKCcwJyArIChkLmdldE1vbnRoKCkgKyAxKSkuc2xpY2UoLTIpICsgJy8nICsgZC5nZXRGdWxsWWVhcigpO1xuICAgICAgICBcblxuICAgICAgICBjb25zdCBwb29sID0gYXdhaXQgb3JhY2xlLmdldENvbm5lY3Rpb24oKTtcbiAgICAgICAgcG9vbC5leGVjdXRlKFwiU0VMRUNUICogRlJPTSBWMDdfSWRydXNfY2V4X2RpYXMgV0hFUkUgZmVjaGFfY2l0YSA+IHRvX2RhdGUoOmZlY2hhY2l0YSwnREQvTU0vWVlZWScpIEFORCBmZWNoYV9jaXRhIDwgdG9fZGF0ZSg6ZmVjaGFjaXRhbWFzdW5vLCdERC9NTS9ZWVlZJylcIiAsW2ZlY2hhY2l0YSwgZmVjaGFjaXRhbWFzdW5vXSwge291dEZvcm1hdDogb3JhY2xlZGIuT0JKRUNUfSwgXG4gICAgICAgIGZ1bmN0aW9uKGVycixyZXN1bHQpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2cgKCdFcnJvciBlbCBlamVjdXRhciBsYSBxdWVyeTonICsgZXJyLm1lc3NhZ2UpXG4gICAgICAgICAgICByZXMud3JpdGVIZWFkKDUwMCwgeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9KTtcbiAgICAgICAgICAgIHJlcy5lbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIHN0YXR1czo1MDAsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTpcIkVycm9yIHByaXZhdGUgdGhpbmdzXCIsXG4gICAgICAgICAgICAgICAgZGV0YWlsZWRfbWVzc2FnZTogZXJyLm1lc3NhZ2VcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVzLndyaXRlSGVhZCgyMDAsIHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSk7XG4gICAgICAgICAgICByZXMuZW5kKEpTT04uc3RyaW5naWZ5KHJlc3VsdC5yb3dzKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgKTtcbn0gXG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFBNEI7QUFFNUIsSUFBSUEsTUFBTSxHQUFJQyxPQUFPLENBQUMsMkJBQTJCLENBQUM7QUFFbEQsU0FBU0MsV0FBVyxDQUFDQyxLQUFLLEVBQUU7RUFFeEIsSUFBR0EsS0FBSyxDQUFDQyxNQUFNLEtBQUssQ0FBQyxFQUFFO0lBQ25CLE9BQU8sS0FBSztFQUNoQjtFQUNBLE1BQU1DLEdBQUcsR0FBR0YsS0FBSyxDQUFDRyxNQUFNLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztFQUM3QixNQUFNQyxHQUFHLEdBQUdKLEtBQUssQ0FBQ0csTUFBTSxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUM7RUFDN0IsTUFBTUUsR0FBRyxHQUFHTCxLQUFLLENBQUNHLE1BQU0sQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDO0VBRTdCRyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsR0FBRyxHQUFHLEdBQUcsR0FBR0QsR0FBRyxHQUFHLEdBQUcsR0FBR0YsR0FBRyxDQUFDO0VBRXhDLElBQUlNLElBQUksR0FBRyxJQUFBQyxlQUFNLEVBQUNULEtBQUssRUFBQyxVQUFVLENBQUM7RUFFbkMsSUFBSVEsSUFBSSxDQUFDRSxPQUFPLEVBQUUsRUFBRSxPQUFPLElBQUk7RUFFL0IsT0FBTyxLQUFLO0FBRWhCO0FBRU8sTUFBTUMsV0FBVyxHQUFHLE9BQU1DLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUk7RUFFL0M7O0VBRUEsSUFBSWQsS0FBSyxHQUFHWSxHQUFHLENBQUNHLEtBQUssQ0FBQ2YsS0FBSztFQUczQixJQUFJQSxLQUFLLEtBQUlnQixTQUFTLElBQUksQ0FBQ2pCLFdB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","map":{"version":3,"names":["oracle","require","fechaValida","fecha","length","eje","substr","mes","dia","console","log","date","moment","isValid","getCitasCEX","req","res","next","query","undefined","writeHead","end","JSON","stringify","status","message","detailed_message","fechacita","fechacitamasuno","d","Date","setDate","getDate","slice","getMonth","getFullYear","pool","getConnection","execute","outFormat","oracledb","OBJECT","err","result","rows"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/controllers/","sources":["citas.controller.js"],"sourcesContent":["import oracledb from 'oracledb';\nimport moment from 'moment';\n\nvar oracle =  require('../database/connection.js')\n\nfunction fechaValida(fecha) {\n\n    if(fecha.length !== 8) {\n        return false\n    }\n    const eje = fecha.substr(0,4);\n    const mes = fecha.substr(4,2);\n    const dia = fecha.substr(6,2);\n\n    console.log(dia + '/' + mes + '/' + eje)\n\n    var date = moment(fecha,'YYYYMMDD');\n    \n    if (date.isValid()) return true;\n\n    return false;\n\n}\n\nexport const getCitasCEX = async(req, res, next) =>{\n   \n    //Validar fecha \n \n    var fecha = req.query.fecha;\n  \n\n    if (fecha ===undefined || !fechaValida(fecha)) {\n        res.writeHead(500, {'Content-Type': 'application/json'});\n            res.end(JSON.stringify({\n                status:500,\n                message:\"Fecha Erronea\",\n                detailed_message: \"Introduzca una fecha válida (YYYYMMDD)\"\n            }));\n        \n    } else {\n        \n        const eje = fecha.substr(0,4);\n        const mes = fecha.substr(4,2);\n        const dia = fecha.substr(6,2);\n        \n        const fechacita = dia + '/' + mes + '/' + eje;\n        var fechacitamasuno;\n\n    \n        var d = new Date(eje + '-' + mes + '-' + dia)\n        d.setDate(d.getDate() + 1)\n        fechacitamasuno = ('0' + d.getDate()).slice(-2) + '/' +  ('0' + (d.getMonth() + 1)).slice(-2) + '/' + d.getFullYear();\n        \n\n        const pool = await oracle.getConnection();\n        pool.execute(\"SELECT * FROM V07_Idrus_cex_dias WHERE fecha_cita > to_date(:fechacita,'DD/MM/YYYY') AND fecha_cita < to_date(:fechacitamasuno,'DD/MM/YYYY')\" ,[fechacita, fechacitamasuno], {outFormat: oracledb.OBJECT}, \n        function(err,result) {\n        if (err) {\n            console.log ('Error el ejecutar la query:' + err.message)\n            res.writeHead(500, {'Content-Type': 'application/json'});\n            res.end(JSON.stringify({\n                status:500,\n                message:\"Error private things\",\n                detailed_message: err.message\n            }));\n        }\n        else {\n            \n            res.writeHead(200, {'Content-Type': 'application/json'});\n            res.end(JSON.stringify(result.rows));\n        }\n    }\n    );\n} \n}\n"],"mappings":"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"}},"mtime":1666102235969},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/database/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/database/connection.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getConnection = getConnection;\nconst oracledb = require(\"oracledb\");\noracledb.autoCommit = true;\nlet connection;\nasync function getConnection() {\n  try {\n    connection = await oracledb.getConnection({\n      user: process.env.DB_USER,\n      password: process.env.DB_PASS,\n      connectionString: process.env.DB_TNS\n    });\n    return connection;\n  } catch (err) {\n    console.error(err.message);\n  }\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcmFjbGVkYiIsInJlcXVpcmUiLCJhdXRvQ29tbWl0IiwiY29ubmVjdGlvbiIsImdldENvbm5lY3Rpb24iLCJ1c2VyIiwicHJvY2VzcyIsImVudiIsIkRCX1VTRVIiLCJwYXNzd29yZCIsIkRCX1BBU1MiLCJjb25uZWN0aW9uU3RyaW5nIiwiREJfVE5TIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiL2hvbWUvYzA3LWFkbWluaXN0cmFkb3IvanMvb3JhY2xlL2JhY2tlbmRzL2lkcnVzL2RhdGFiYXNlLyIsInNvdXJjZXMiOlsiY29ubmVjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBvcmFjbGVkYiA9IHJlcXVpcmUoXCJvcmFjbGVkYlwiKTtcbm9yYWNsZWRiLmF1dG9Db21taXQ9IHRydWU7XG5cbmxldCBjb25uZWN0aW9uO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29ubmVjdGlvbigpIHtcbiAgdHJ5IHtcbiAgICBjb25uZWN0aW9uID0gYXdhaXQgb3JhY2xlZGIuZ2V0Q29ubmVjdGlvbih7XG4gICAgICB1c2VyOiBwcm9jZXNzLmVudi5EQl9VU0VSLFxuICAgICAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LkRCX1BBU1MsXG4gICAgICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQl9UTlMsXG4gICAgfSk7XG4gICAgcmV0dXJuIGNvbm5lY3Rpb247XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyLm1lc3NhZ2UpO1xuICB9IFxufVxuXG5cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3BDRCxRQUFRLENBQUNFLFVBQVUsR0FBRSxJQUFJO0FBRXpCLElBQUlDLFVBQVU7QUFFUCxlQUFlQyxhQUFhLEdBQUc7RUFDcEMsSUFBSTtJQUNGRCxVQUFVLEdBQUcsTUFBTUgsUUFBUSxDQUFDSSxhQUFhLENBQUM7TUFDeENDLElBQUksRUFBRUMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLE9BQU87TUFDekJDLFFBQVEsRUFBRUgsT0FBTyxDQUFDQyxHQUFHLENBQUNHLE9BQU87TUFDN0JDLGdCQUFnQixFQUFFTCxPQUFPLENBQUNDLEdBQUcsQ0FBQ0s7SUFDaEMsQ0FBQyxDQUFDO0lBQ0YsT0FBT1QsVUFBVTtFQUNuQixDQUFDLENBQUMsT0FBT1UsR0FBRyxFQUFFO0lBQ1pDLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDRixHQUFHLENBQUNHLE9BQU8sQ0FBQztFQUM1QjtBQUNGIn0=","map":{"version":3,"names":["oracledb","require","autoCommit","connection","getConnection","user","process","env","DB_USER","password","DB_PASS","connectionString","DB_TNS","err","console","error","message"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/database/","sources":["connection.js"],"sourcesContent":["const oracledb = require(\"oracledb\");\noracledb.autoCommit= true;\n\nlet connection;\n\nexport async function getConnection() {\n  try {\n    connection = await oracledb.getConnection({\n      user: process.env.DB_USER,\n      password: process.env.DB_PASS,\n      connectionString: process.env.DB_TNS,\n    });\n    return connection;\n  } catch (err) {\n    console.error(err.message);\n  } \n}\n\n\n"],"mappings":";;;;;;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpCD,QAAQ,CAACE,UAAU,GAAE,IAAI;AAEzB,IAAIC,UAAU;AAEP,eAAeC,aAAa,GAAG;EACpC,IAAI;IACFD,UAAU,GAAG,MAAMH,QAAQ,CAACI,aAAa,CAAC;MACxCC,IAAI,EAAEC,OAAO,CAACC,GAAG,CAACC,OAAO;MACzBC,QAAQ,EAAEH,OAAO,CAACC,GAAG,CAACG,OAAO;MAC7BC,gBAAgB,EAAEL,OAAO,CAACC,GAAG,CAACK;IAChC,CAAC,CAAC;IACF,OAAOT,UAAU;EACnB,CAAC,CAAC,OAAOU,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAACF,GAAG,CAACG,OAAO,CAAC;EAC5B;AACF"}},"mtime":1665997615203},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/auth.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nvar jwt = require('jsonwebtoken');\nvar config = require('../config.js');\nfunction auth(role) {\n  return async function (req, res, next) {\n    var token;\n    var payload;\n    if (!req.headers.authorization) {\n      return res.status(401).send({\n        message: \"No autorizado\"\n      });\n    }\n    token = req.headers.authorization.split(' ')[1];\n    try {\n      payload = jwt.verify(token, process.env.JWTSECRETKEY);\n    } catch (e) {\n      if (e.name === 'TokenExpiredError') {\n        res.status(401).send({\n          message: \"Autorización expirada. Contacte con HospitalTenerife@sjd.es\"\n        });\n      } else {\n        res.status(401).send({\n          message: \"Autorización invalida\"\n        });\n      }\n      return;\n    }\n    if (!role || role === payload.role) {\n      req.user = {\n        email: payload.sub,\n        role: payload.role\n      };\n      next();\n    } else {\n      res.status(401).send({\n        message: 'No estas autorizado'\n      });\n    }\n  };\n}\nmodule.exports = auth;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiY29uZmlnIiwiYXV0aCIsInJvbGUiLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJwYXlsb2FkIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJzdGF0dXMiLCJzZW5kIiwibWVzc2FnZSIsInNwbGl0IiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVFNFQ1JFVEtFWSIsImUiLCJuYW1lIiwidXNlciIsImVtYWlsIiwic3ViIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYzA3LWFkbWluaXN0cmFkb3IvanMvb3JhY2xlL2JhY2tlbmRzL2lkcnVzL3JvdXRlcy8iLCJzb3VyY2VzIjpbImF1dGguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXG52YXIgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XG52YXIgY29uZmlnID0gIHJlcXVpcmUgKCcuLi9jb25maWcuanMnKVxuXG5mdW5jdGlvbiBhdXRoKHJvbGUpIHtcblxuICAgIHJldHVybiBhc3luYyBmdW5jdGlvbihyZXEsIHJlcywgbmV4dCkge1xuXG4gICAgICAgIHZhciB0b2tlbjtcbiAgICAgICAgdmFyIHBheWxvYWQ7XG5cbiAgICAgICAgaWYgKCFyZXEuaGVhZGVycy5hdXRob3JpemF0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoe21lc3NhZ2U6IFwiTm8gYXV0b3JpemFkb1wifSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRva2VuPXJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24uc3BsaXQoJyAnKVsxXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHBheWxvYWQ9and0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUU0VDUkVUS0VZKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfWNhdGNoIChlKSB7XG4gICAgICAgICAgICBpZiAoZS5uYW1lID09PSAnVG9rZW5FeHBpcmVkRXJyb3InKSB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCh7bWVzc2FnZTogXCJBdXRvcml6YWNpw7NuIGV4cGlyYWRhLiBDb250YWN0ZSBjb24gSG9zcGl0YWxUZW5lcmlmZUBzamQuZXNcIn0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzLnN0YXR1cyg0MDEpLnNlbmQoe21lc3NhZ2U6IFwiQXV0b3JpemFjacOzbiBpbnZhbGlkYVwifSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICBpZiAoIXJvbGUgfHwgcm9sZSA9PT0gcGF5bG9hZC5yb2xlICkge1xuICAgICAgICAgICAgcmVxLnVzZXIgPSB7XG4gICAgICAgICAgICAgICAgZW1haWw6IHBheWxvYWQuc3ViLFxuICAgICAgICAgICAgICAgIHJvbGU6IHBheWxvYWQucm9sZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG5leHQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5zZW5kKHttZXNzYWdlOiAnTm8gZXN0YXMgYXV0b3JpemFkbyd9KTtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbn1cbm1vZHVsZS5leHBvcnRzID0gYXV0aDtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFDQSxJQUFJQSxHQUFHLEdBQUdDLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDakMsSUFBSUMsTUFBTSxHQUFJRCxPQUFPLENBQUUsY0FBYyxDQUFDO0FBRXRDLFNBQVNFLElBQUksQ0FBQ0MsSUFBSSxFQUFFO0VBRWhCLE9BQU8sZ0JBQWVDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFFbEMsSUFBSUMsS0FBSztJQUNULElBQUlDLE9BQU87SUFFWCxJQUFJLENBQUNKLEdBQUcsQ0FBQ0ssT0FBTyxDQUFDQyxhQUFhLEVBQUU7TUFDNUIsT0FBT0wsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFDQyxPQUFPLEVBQUU7TUFBZSxDQUFDLENBQUM7SUFDdkQ7SUFDQU4sS0FBSyxHQUFDSCxHQUFHLENBQUNLLE9BQU8sQ0FBQ0MsYUFBYSxDQUFDSSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRTdDLElBQUk7TUFDSk4sT0FBTyxHQUFDVCxHQUFHLENBQUNnQixNQUFNLENBQUNSLEtBQUssRUFBRVMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFlBQVksQ0FBQztJQUVuRCxDQUFDLFFBQU9DLENBQUMsRUFBRTtNQUNYLElBQUlBLENBQUMsQ0FBQ0MsSUFBSSxLQUFLLG1CQUFtQixFQUFFO1FBQ3BDZixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1VBQUNDLE9BQU8sRUFBRTtRQUE2RCxDQUFDLENBQUM7TUFDOUYsQ0FBQyxNQUFNO1FBQ1BSLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBQ0MsT0FBTyxFQUFFO1FBQXVCLENBQUMsQ0FBQztNQUN4RDtNQUNBO0lBQ0E7SUFDSixJQUFJLENBQUNWLElBQUksSUFBSUEsSUFBSSxLQUFLSyxPQUFPLENBQUNMLElBQUksRUFBRztNQUNqQ0MsR0FBRyxDQUFDaUIsSUFBSSxHQUFHO1FBQ1BDLEtBQUssRUFBRWQsT0FBTyxDQUFDZSxHQUFHO1FBQ2xCcEIsSUFBSSxFQUFFSyxPQUFPLENBQUNMO01BQ2xCLENBQUM7TUFDREcsSUFBSSxFQUFFO0lBQ1YsQ0FBQyxNQUFNO01BQ0hELEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7UUFBQ0MsT0FBTyxFQUFFO01BQXFCLENBQUMsQ0FBQztJQUUxRDtFQUVKLENBQUM7QUFFTDtBQUNBVyxNQUFNLENBQUNDLE9BQU8sR0FBR3ZCLElBQUkifQ==","map":{"version":3,"names":["jwt","require","config","auth","role","req","res","next","token","payload","headers","authorization","status","send","message","split","verify","process","env","JWTSECRETKEY","e","name","user","email","sub","module","exports"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/routes/","sources":["auth.js"],"sourcesContent":["\nvar jwt = require('jsonwebtoken');\nvar config =  require ('../config.js')\n\nfunction auth(role) {\n\n    return async function(req, res, next) {\n\n        var token;\n        var payload;\n\n        if (!req.headers.authorization) {\n            return res.status(401).send({message: \"No autorizado\"})\n            }\n            token=req.headers.authorization.split(' ')[1];\n            \n            try {\n            payload=jwt.verify(token, process.env.JWTSECRETKEY);\n            \n            }catch (e) {\n            if (e.name === 'TokenExpiredError') {\n            res.status(401).send({message: \"Autorización expirada. Contacte con HospitalTenerife@sjd.es\"})\n            } else {\n            res.status(401).send({message: \"Autorización invalida\"})\n            }\n            return\n            }\n        if (!role || role === payload.role ) {\n            req.user = {\n                email: payload.sub,\n                role: payload.role\n            };\n            next();\n        } else {\n            res.status(401).send({message: 'No estas autorizado'});\n\n        }\n\n    }\n\n}\nmodule.exports = auth;\n"],"mappings":";;AACA,IAAIA,GAAG,GAAGC,OAAO,CAAC,cAAc,CAAC;AACjC,IAAIC,MAAM,GAAID,OAAO,CAAE,cAAc,CAAC;AAEtC,SAASE,IAAI,CAACC,IAAI,EAAE;EAEhB,OAAO,gBAAeC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IAElC,IAAIC,KAAK;IACT,IAAIC,OAAO;IAEX,IAAI,CAACJ,GAAG,CAACK,OAAO,CAACC,aAAa,EAAE;MAC5B,OAAOL,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAACC,OAAO,EAAE;MAAe,CAAC,CAAC;IACvD;IACAN,KAAK,GAACH,GAAG,CAACK,OAAO,CAACC,aAAa,CAACI,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAE7C,IAAI;MACJN,OAAO,GAACT,GAAG,CAACgB,MAAM,CAACR,KAAK,EAAES,OAAO,CAACC,GAAG,CAACC,YAAY,CAAC;IAEnD,CAAC,QAAOC,CAAC,EAAE;MACX,IAAIA,CAAC,CAACC,IAAI,KAAK,mBAAmB,EAAE;QACpCf,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAACC,OAAO,EAAE;QAA6D,CAAC,CAAC;MAC9F,CAAC,MAAM;QACPR,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAACC,OAAO,EAAE;QAAuB,CAAC,CAAC;MACxD;MACA;IACA;IACJ,IAAI,CAACV,IAAI,IAAIA,IAAI,KAAKK,OAAO,CAACL,IAAI,EAAG;MACjCC,GAAG,CAACiB,IAAI,GAAG;QACPC,KAAK,EAAEd,OAAO,CAACe,GAAG;QAClBpB,IAAI,EAAEK,OAAO,CAACL;MAClB,CAAC;MACDG,IAAI,EAAE;IACV,CAAC,MAAM;MACHD,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAACC,OAAO,EAAE;MAAqB,CAAC,CAAC;IAE1D;EAEJ,CAAC;AAEL;AACAW,MAAM,CAACC,OAAO,GAAGvB,IAAI"}},"mtime":1666005896919},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _dotenv = require(\"dotenv\");\n(0, _dotenv.config)();\nvar _default = {\n  port: process.env.PORT\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb25maWciLCJwb3J0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiXSwic291cmNlUm9vdCI6Ii9ob21lL2MwNy1hZG1pbmlzdHJhZG9yL2pzL29yYWNsZS9iYWNrZW5kcy9pZHJ1cy8iLCJzb3VyY2VzIjpbImNvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2NvbmZpZ30gZnJvbSBcImRvdGVudlwiO1xuXG5jb25maWcoKTtcblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIHBvcnQ6IHByb2Nlc3MuZW52LlBPUlRcbiAgICBcblxufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFFQSxJQUFBQSxjQUFNLEdBQUU7QUFBQyxlQUVNO0VBQ1hDLElBQUksRUFBRUMsT0FBTyxDQUFDQyxHQUFHLENBQUNDO0FBR3RCLENBQUM7QUFBQSJ9","map":{"version":3,"names":["config","port","process","env","PORT"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/","sources":["config.js"],"sourcesContent":["import {config} from \"dotenv\";\n\nconfig();\n\nexport default {\n    port: process.env.PORT\n    \n\n}"],"mappings":";;;;;;AAAA;AAEA,IAAAA,cAAM,GAAE;AAAC,eAEM;EACXC,IAAI,EAAEC,OAAO,CAACC,GAAG,CAACC;AAGtB,CAAC;AAAA"}},"mtime":1665997615203},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/citas.routes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _auth = _interopRequireDefault(require(\"./auth\"));\nvar _citas = require(\"../controllers/citas.controller\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nvar express = require('express');\nconst router = express.Router();\nrouter.get('/api/citas/', (0, _auth.default)(), _citas.getCitasCEX);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImdldCIsImF1dGgiLCJnZXRDaXRhc0NFWCJdLCJzb3VyY2VSb290IjoiL2hvbWUvYzA3LWFkbWluaXN0cmFkb3IvanMvb3JhY2xlL2JhY2tlbmRzL2lkcnVzL3JvdXRlcy8iLCJzb3VyY2VzIjpbImNpdGFzLnJvdXRlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCBhdXRoIGZyb20gXCIuL2F1dGhcIjtcblxuaW1wb3J0IHtnZXRDaXRhc0NFWH0gZnJvbSAnLi4vY29udHJvbGxlcnMvY2l0YXMuY29udHJvbGxlcidcblxudmFyIGV4cHJlc3MgPSByZXF1aXJlICgnZXhwcmVzcycpO1xuXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG5cbnJvdXRlci5nZXQoJy9hcGkvY2l0YXMvJywgYXV0aCgpLCAgZ2V0Q2l0YXNDRVgpO1xuXG5cblxuZXhwb3J0IGRlZmF1bHQgcm91dGVyO1xuXG5cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0E7QUFFQTtBQUEyRDtBQUUzRCxJQUFJQSxPQUFPLEdBQUdDLE9BQU8sQ0FBRSxTQUFTLENBQUM7QUFFakMsTUFBTUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQU0sRUFBRTtBQUcvQkQsTUFBTSxDQUFDRSxHQUFHLENBQUMsYUFBYSxFQUFFLElBQUFDLGFBQUksR0FBRSxFQUFHQyxrQkFBVyxDQUFDO0FBQUMsZUFJakNKLE1BQU07QUFBQSJ9","map":{"version":3,"names":["express","require","router","Router","get","auth","getCitasCEX"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/routes/","sources":["citas.routes.js"],"sourcesContent":["\nimport auth from \"./auth\";\n\nimport {getCitasCEX} from '../controllers/citas.controller'\n\nvar express = require ('express');\n\nconst router = express.Router();\n\n\nrouter.get('/api/citas/', auth(),  getCitasCEX);\n\n\n\nexport default router;\n\n\n"],"mappings":";;;;;;AACA;AAEA;AAA2D;AAE3D,IAAIA,OAAO,GAAGC,OAAO,CAAE,SAAS,CAAC;AAEjC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,EAAE;AAG/BD,MAAM,CAACE,GAAG,CAAC,aAAa,EAAE,IAAAC,aAAI,GAAE,EAAGC,kBAAW,CAAC;AAAC,eAIjCJ,MAAM;AAAA"}},"mtime":1666102235969},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/controllers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/controllers/citas.controller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCitas = void 0;\nvar _oracledb = _interopRequireDefault(require(\"oracledb\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nvar oracle = require('../database/connection.js');\nfunction fechaValida(fecha) {\n  if (fecha.length !== 8) {\n    return false;\n  }\n  const eje = fecha.substr(0, 4);\n  const mes = fecha.substr(4, 2);\n  const dia = fecha.substr(6, 2);\n  console.log(dia + '/' + mes + '/' + eje);\n  var date = (0, _moment.default)(fecha, 'YYYYMMDD');\n  if (date.isValid()) return true;\n  return false;\n}\nconst getCitas = async (req, res, next) => {\n  //Validar fecha \n\n  var fecha = req.query.fecha;\n  if (fecha === undefined || !fechaValida(fecha)) {\n    res.writeHead(500, {\n      'Content-Type': 'application/json'\n    });\n    res.end(JSON.stringify({\n      status: 500,\n      message: \"Fecha Erronea\",\n      detailed_message: \"Introduzca una fecha válida (YYYYMMDD)\"\n    }));\n  } else {\n    const eje = fecha.substr(0, 4);\n    const mes = fecha.substr(4, 2);\n    const dia = fecha.substr(6, 2);\n    const fechacita = dia + '/' + mes + '/' + eje;\n    var fechacitamasuno;\n    var d = new Date(eje + '-' + mes + '-' + dia);\n    d.setDate(d.getDate() + 1);\n    fechacitamasuno = ('0' + d.getDate()).slice(-2) + '/' + ('0' + (d.getMonth() + 1)).slice(-2) + '/' + d.getFullYear();\n    const pool = await oracle.getConnection();\n    pool.execute(\"SELECT * FROM V07_Idrus_cex_dias WHERE fecha_cita > to_date(:fechacita,'DD/MM/YYYY') AND fecha_cita < to_date(:fechacitamasuno,'DD/MM/YYYY')\", [fechacita, fechacitamasuno], {\n      outFormat: _oracledb.default.OBJECT\n    }, function (err, result) {\n      if (err) {\n        console.log('Error el ejecutar la query:' + err.message);\n        res.writeHead(500, {\n          'Content-Type': 'application/json'\n        });\n        res.end(JSON.stringify({\n          status: 500,\n          message: \"Error private things\",\n          detailed_message: err.message\n        }));\n      } else {\n        res.writeHead(200, {\n          'Content-Type': 'application/json'\n        });\n        res.end(JSON.stringify(result.rows));\n      }\n    });\n  }\n};\nexports.getCitas = getCitas;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcmFjbGUiLCJyZXF1aXJlIiwiZmVjaGFWYWxpZGEiLCJmZWNoYSIsImxlbmd0aCIsImVqZSIsInN1YnN0ciIsIm1lcyIsImRpYSIsImNvbnNvbGUiLCJsb2ciLCJkYXRlIiwibW9tZW50IiwiaXNWYWxpZCIsImdldENpdGFzIiwicmVxIiwicmVzIiwibmV4dCIsInF1ZXJ5IiwidW5kZWZpbmVkIiwid3JpdGVIZWFkIiwiZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsInN0YXR1cyIsIm1lc3NhZ2UiLCJkZXRhaWxlZF9tZXNzYWdlIiwiZmVjaGFjaXRhIiwiZmVjaGFjaXRhbWFzdW5vIiwiZCIsIkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsInNsaWNlIiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsInBvb2wiLCJnZXRDb25uZWN0aW9uIiwiZXhlY3V0ZSIsIm91dEZvcm1hdCIsIm9yYWNsZWRiIiwiT0JKRUNUIiwiZXJyIiwicmVzdWx0Iiwicm93cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYzA3LWFkbWluaXN0cmFkb3IvanMvb3JhY2xlL2JhY2tlbmRzL2lkcnVzL2NvbnRyb2xsZXJzLyIsInNvdXJjZXMiOlsiY2l0YXMuY29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgb3JhY2xlZGIgZnJvbSAnb3JhY2xlZGInO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuXG52YXIgb3JhY2xlID0gIHJlcXVpcmUoJy4uL2RhdGFiYXNlL2Nvbm5lY3Rpb24uanMnKVxuXG5mdW5jdGlvbiBmZWNoYVZhbGlkYShmZWNoYSkge1xuXG4gICAgaWYoZmVjaGEubGVuZ3RoICE9PSA4KSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICBjb25zdCBlamUgPSBmZWNoYS5zdWJzdHIoMCw0KTtcbiAgICBjb25zdCBtZXMgPSBmZWNoYS5zdWJzdHIoNCwyKTtcbiAgICBjb25zdCBkaWEgPSBmZWNoYS5zdWJzdHIoNiwyKTtcblxuICAgIGNvbnNvbGUubG9nKGRpYSArICcvJyArIG1lcyArICcvJyArIGVqZSlcblxuICAgIHZhciBkYXRlID0gbW9tZW50KGZlY2hhLCdZWVlZTU1ERCcpO1xuICAgIFxuICAgIGlmIChkYXRlLmlzVmFsaWQoKSkgcmV0dXJuIHRydWU7XG5cbiAgICByZXR1cm4gZmFsc2U7XG5cbn1cblxuZXhwb3J0IGNvbnN0IGdldENpdGFzID0gYXN5bmMocmVxLCByZXMsIG5leHQpID0+e1xuICAgXG4gICAgLy9WYWxpZGFyIGZlY2hhIFxuIFxuICAgIHZhciBmZWNoYSA9IHJlcS5xdWVyeS5mZWNoYTtcbiAgXG5cbiAgICBpZiAoZmVjaGEgPT09dW5kZWZpbmVkIHx8ICFmZWNoYVZhbGlkYShmZWNoYSkpIHtcbiAgICAgICAgcmVzLndyaXRlSGVhZCg1MDAsIHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSk7XG4gICAgICAgICAgICByZXMuZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6NTAwLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6XCJGZWNoYSBFcnJvbmVhXCIsXG4gICAgICAgICAgICAgICAgZGV0YWlsZWRfbWVzc2FnZTogXCJJbnRyb2R1emNhIHVuYSBmZWNoYSB2w6FsaWRhIChZWVlZTU1ERClcIlxuICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICB9IGVsc2Uge1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZWplID0gZmVjaGEuc3Vic3RyKDAsNCk7XG4gICAgICAgIGNvbnN0IG1lcyA9IGZlY2hhLnN1YnN0cig0LDIpO1xuICAgICAgICBjb25zdCBkaWEgPSBmZWNoYS5zdWJzdHIoNiwyKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZlY2hhY2l0YSA9IGRpYSArICcvJyArIG1lcyArICcvJyArIGVqZTtcbiAgICAgICAgdmFyIGZlY2hhY2l0YW1hc3VubztcblxuICAgIFxuICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKGVqZSArICctJyArIG1lcyArICctJyArIGRpYSlcbiAgICAgICAgZC5zZXREYXRlKGQuZ2V0RGF0ZSgpICsgMSlcbiAgICAgICAgZmVjaGFjaXRhbWFzdW5vID0gKCcwJyArIGQuZ2V0RGF0ZSgpKS5zbGljZSgtMikgKyAnLycgKyAgKCcwJyArIChkLmdldE1vbnRoKCkgKyAxKSkuc2xpY2UoLTIpICsgJy8nICsgZC5nZXRGdWxsWWVhcigpO1xuICAgICAgICBcblxuICAgICAgICBjb25zdCBwb29sID0gYXdhaXQgb3JhY2xlLmdldENvbm5lY3Rpb24oKTtcbiAgICAgICAgcG9vbC5leGVjdXRlKFwiU0VMRUNUICogRlJPTSBWMDdfSWRydXNfY2V4X2RpYXMgV0hFUkUgZmVjaGFfY2l0YSA+IHRvX2RhdGUoOmZlY2hhY2l0YSwnREQvTU0vWVlZWScpIEFORCBmZWNoYV9jaXRhIDwgdG9fZGF0ZSg6ZmVjaGFjaXRhbWFzdW5vLCdERC9NTS9ZWVlZJylcIiAsW2ZlY2hhY2l0YSwgZmVjaGFjaXRhbWFzdW5vXSwge291dEZvcm1hdDogb3JhY2xlZGIuT0JKRUNUfSwgXG4gICAgICAgIGZ1bmN0aW9uKGVycixyZXN1bHQpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2cgKCdFcnJvciBlbCBlamVjdXRhciBsYSBxdWVyeTonICsgZXJyLm1lc3NhZ2UpXG4gICAgICAgICAgICByZXMud3JpdGVIZWFkKDUwMCwgeydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9KTtcbiAgICAgICAgICAgIHJlcy5lbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIHN0YXR1czo1MDAsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTpcIkVycm9yIHByaXZhdGUgdGhpbmdzXCIsXG4gICAgICAgICAgICAgICAgZGV0YWlsZWRfbWVzc2FnZTogZXJyLm1lc3NhZ2VcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVzLndyaXRlSGVhZCgyMDAsIHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSk7XG4gICAgICAgICAgICByZXMuZW5kKEpTT04uc3RyaW5naWZ5KHJlc3VsdC5yb3dzKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgKTtcbn0gXG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFBNEI7QUFFNUIsSUFBSUEsTUFBTSxHQUFJQyxPQUFPLENBQUMsMkJBQTJCLENBQUM7QUFFbEQsU0FBU0MsV0FBVyxDQUFDQyxLQUFLLEVBQUU7RUFFeEIsSUFBR0EsS0FBSyxDQUFDQyxNQUFNLEtBQUssQ0FBQyxFQUFFO0lBQ25CLE9BQU8sS0FBSztFQUNoQjtFQUNBLE1BQU1DLEdBQUcsR0FBR0YsS0FBSyxDQUFDRyxNQUFNLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztFQUM3QixNQUFNQyxHQUFHLEdBQUdKLEtBQUssQ0FBQ0csTUFBTSxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUM7RUFDN0IsTUFBTUUsR0FBRyxHQUFHTCxLQUFLLENBQUNHLE1BQU0sQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDO0VBRTdCRyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsR0FBRyxHQUFHLEdBQUcsR0FBR0QsR0FBRyxHQUFHLEdBQUcsR0FBR0YsR0FBRyxDQUFDO0VBRXhDLElBQUlNLElBQUksR0FBRyxJQUFBQyxlQUFNLEVBQUNULEtBQUssRUFBQyxVQUFVLENBQUM7RUFFbkMsSUFBSVEsSUFBSSxDQUFDRSxPQUFPLEVBQUUsRUFBRSxPQUFPLElBQUk7RUFFL0IsT0FBTyxLQUFLO0FBRWhCO0FBRU8sTUFBTUMsUUFBUSxHQUFHLE9BQU1DLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUk7RUFFNUM7O0VBRUEsSUFBSWQsS0FBSyxHQUFHWSxHQUFHLENBQUNHLEtBQUssQ0FBQ2YsS0FBSztFQUczQixJQUFJQSxLQUFLLEtBQUlnQixTQUFTLElBQUksQ0FBQ2pCLFdBQVcsQ0FB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","map":{"version":3,"names":["oracle","require","fechaValida","fecha","length","eje","substr","mes","dia","console","log","date","moment","isValid","getCitas","req","res","next","query","undefined","writeHead","end","JSON","stringify","status","message","detailed_message","fechacita","fechacitamasuno","d","Date","setDate","getDate","slice","getMonth","getFullYear","pool","getConnection","execute","outFormat","oracledb","OBJECT","err","result","rows"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/controllers/","sources":["citas.controller.js"],"sourcesContent":["import oracledb from 'oracledb';\nimport moment from 'moment';\n\nvar oracle =  require('../database/connection.js')\n\nfunction fechaValida(fecha) {\n\n    if(fecha.length !== 8) {\n        return false\n    }\n    const eje = fecha.substr(0,4);\n    const mes = fecha.substr(4,2);\n    const dia = fecha.substr(6,2);\n\n    console.log(dia + '/' + mes + '/' + eje)\n\n    var date = moment(fecha,'YYYYMMDD');\n    \n    if (date.isValid()) return true;\n\n    return false;\n\n}\n\nexport const getCitas = async(req, res, next) =>{\n   \n    //Validar fecha \n \n    var fecha = req.query.fecha;\n  \n\n    if (fecha ===undefined || !fechaValida(fecha)) {\n        res.writeHead(500, {'Content-Type': 'application/json'});\n            res.end(JSON.stringify({\n                status:500,\n                message:\"Fecha Erronea\",\n                detailed_message: \"Introduzca una fecha válida (YYYYMMDD)\"\n            }));\n        \n    } else {\n        \n        const eje = fecha.substr(0,4);\n        const mes = fecha.substr(4,2);\n        const dia = fecha.substr(6,2);\n        \n        const fechacita = dia + '/' + mes + '/' + eje;\n        var fechacitamasuno;\n\n    \n        var d = new Date(eje + '-' + mes + '-' + dia)\n        d.setDate(d.getDate() + 1)\n        fechacitamasuno = ('0' + d.getDate()).slice(-2) + '/' +  ('0' + (d.getMonth() + 1)).slice(-2) + '/' + d.getFullYear();\n        \n\n        const pool = await oracle.getConnection();\n        pool.execute(\"SELECT * FROM V07_Idrus_cex_dias WHERE fecha_cita > to_date(:fechacita,'DD/MM/YYYY') AND fecha_cita < to_date(:fechacitamasuno,'DD/MM/YYYY')\" ,[fechacita, fechacitamasuno], {outFormat: oracledb.OBJECT}, \n        function(err,result) {\n        if (err) {\n            console.log ('Error el ejecutar la query:' + err.message)\n            res.writeHead(500, {'Content-Type': 'application/json'});\n            res.end(JSON.stringify({\n                status:500,\n                message:\"Error private things\",\n                detailed_message: err.message\n            }));\n        }\n        else {\n            \n            res.writeHead(200, {'Content-Type': 'application/json'});\n            res.end(JSON.stringify(result.rows));\n        }\n    }\n    );\n} \n}\n"],"mappings":"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"}},"mtime":1666102144508},"{\"assumptions\":{},\"sourceRoot\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"filename\":\"/home/c07-administrador/js/oracle/backends/idrus/routes/auth.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/c07-administrador/js/oracle/backends/idrus\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.19.3:development":{"value":{"code":"\"use strict\";\n\nvar jwt = require('jsonwebtoken');\nvar config = require('../config.js');\nfunction auth(role) {\n  return async function (req, res, next) {\n    var token;\n    var payload;\n    if (!req.headers.authorization) {\n      return res.status(401).send({\n        message: \"No autorizado\"\n      });\n    }\n    token = req.headers.authorization.split(' ')[1];\n    try {\n      payload = jwt.verify(token, process.env.JWTSECRETKEY);\n    } catch (e) {\n      if (e.name === 'TokenExpiredError') {\n        res.status(401).send({\n          message: \"Autorización expirada. Contacte con HospitalTenerife@sjd.es\"\n        });\n      } else {\n        res.status(401).send({\n          message: \"Autorización invalida\"\n        });\n      }\n      return;\n    }\n    if (!role || role === payload.role) {\n      req.user = {\n        email: payload.sub,\n        role: payload.role\n      };\n      next();\n    } else {\n      res.status(401).send({\n        message: 'No estas autorizado'\n      });\n    }\n  };\n}\nmodule.exports = auth;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiY29uZmlnIiwiYXV0aCIsInJvbGUiLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJwYXlsb2FkIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJzdGF0dXMiLCJzZW5kIiwibWVzc2FnZSIsInNwbGl0IiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVFNFQ1JFVEtFWSIsImUiLCJuYW1lIiwidXNlciIsImVtYWlsIiwic3ViIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYzA3LWFkbWluaXN0cmFkb3IvanMvb3JhY2xlL2JhY2tlbmRzL2lkcnVzL3JvdXRlcy8iLCJzb3VyY2VzIjpbImF1dGguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXG52YXIgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XG52YXIgY29uZmlnID0gIHJlcXVpcmUgKCcuLi9jb25maWcuanMnKVxuXG5mdW5jdGlvbiBhdXRoKHJvbGUpIHtcblxuICAgIHJldHVybiBhc3luYyBmdW5jdGlvbihyZXEsIHJlcywgbmV4dCkge1xuXG4gICAgICAgIHZhciB0b2tlbjtcbiAgICAgICAgdmFyIHBheWxvYWQ7XG5cbiAgICAgICAgaWYgKCFyZXEuaGVhZGVycy5hdXRob3JpemF0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoe21lc3NhZ2U6IFwiTm8gYXV0b3JpemFkb1wifSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRva2VuPXJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24uc3BsaXQoJyAnKVsxXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHBheWxvYWQ9and0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUU0VDUkVUS0VZKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfWNhdGNoIChlKSB7XG4gICAgICAgICAgICBpZiAoZS5uYW1lID09PSAnVG9rZW5FeHBpcmVkRXJyb3InKSB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCh7bWVzc2FnZTogXCJBdXRvcml6YWNpw7NuIGV4cGlyYWRhLiBDb250YWN0ZSBjb24gSG9zcGl0YWxUZW5lcmlmZUBzamQuZXNcIn0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzLnN0YXR1cyg0MDEpLnNlbmQoe21lc3NhZ2U6IFwiQXV0b3JpemFjacOzbiBpbnZhbGlkYVwifSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICBpZiAoIXJvbGUgfHwgcm9sZSA9PT0gcGF5bG9hZC5yb2xlICkge1xuICAgICAgICAgICAgcmVxLnVzZXIgPSB7XG4gICAgICAgICAgICAgICAgZW1haWw6IHBheWxvYWQuc3ViLFxuICAgICAgICAgICAgICAgIHJvbGU6IHBheWxvYWQucm9sZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG5leHQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5zZW5kKHttZXNzYWdlOiAnTm8gZXN0YXMgYXV0b3JpemFkbyd9KTtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbn1cbm1vZHVsZS5leHBvcnRzID0gYXV0aDtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFDQSxJQUFJQSxHQUFHLEdBQUdDLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDakMsSUFBSUMsTUFBTSxHQUFJRCxPQUFPLENBQUUsY0FBYyxDQUFDO0FBRXRDLFNBQVNFLElBQUksQ0FBQ0MsSUFBSSxFQUFFO0VBRWhCLE9BQU8sZ0JBQWVDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFFbEMsSUFBSUMsS0FBSztJQUNULElBQUlDLE9BQU87SUFFWCxJQUFJLENBQUNKLEdBQUcsQ0FBQ0ssT0FBTyxDQUFDQyxhQUFhLEVBQUU7TUFDNUIsT0FBT0wsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFDQyxPQUFPLEVBQUU7TUFBZSxDQUFDLENBQUM7SUFDdkQ7SUFDQU4sS0FBSyxHQUFDSCxHQUFHLENBQUNLLE9BQU8sQ0FBQ0MsYUFBYSxDQUFDSSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRTdDLElBQUk7TUFDSk4sT0FBTyxHQUFDVCxHQUFHLENBQUNnQixNQUFNLENBQUNSLEtBQUssRUFBRVMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFlBQVksQ0FBQztJQUVuRCxDQUFDLFFBQU9DLENBQUMsRUFBRTtNQUNYLElBQUlBLENBQUMsQ0FBQ0MsSUFBSSxLQUFLLG1CQUFtQixFQUFFO1FBQ3BDZixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1VBQUNDLE9BQU8sRUFBRTtRQUE2RCxDQUFDLENBQUM7TUFDOUYsQ0FBQyxNQUFNO1FBQ1BSLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBQ0MsT0FBTyxFQUFFO1FBQXVCLENBQUMsQ0FBQztNQUN4RDtNQUNBO0lBQ0E7SUFDSixJQUFJLENBQUNWLElBQUksSUFBSUEsSUFBSSxLQUFLSyxPQUFPLENBQUNMLElBQUksRUFBRztNQUNqQ0MsR0FBRyxDQUFDaUIsSUFBSSxHQUFHO1FBQ1BDLEtBQUssRUFBRWQsT0FBTyxDQUFDZSxHQUFHO1FBQ2xCcEIsSUFBSSxFQUFFSyxPQUFPLENBQUNMO01BQ2xCLENBQUM7TUFDREcsSUFBSSxFQUFFO0lBQ1YsQ0FBQyxNQUFNO01BQ0hELEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7UUFBQ0MsT0FBTyxFQUFFO01BQXFCLENBQUMsQ0FBQztJQUUxRDtFQUVKLENBQUM7QUFFTDtBQUNBVyxNQUFNLENBQUNDLE9BQU8sR0FBR3ZCLElBQUkifQ==","map":{"version":3,"names":["jwt","require","config","auth","role","req","res","next","token","payload","headers","authorization","status","send","message","split","verify","process","env","JWTSECRETKEY","e","name","user","email","sub","module","exports"],"sourceRoot":"/home/c07-administrador/js/oracle/backends/idrus/routes/","sources":["auth.js"],"sourcesContent":["\nvar jwt = require('jsonwebtoken');\nvar config =  require ('../config.js')\n\nfunction auth(role) {\n\n    return async function(req, res, next) {\n\n        var token;\n        var payload;\n\n        if (!req.headers.authorization) {\n            return res.status(401).send({message: \"No autorizado\"})\n            }\n            token=req.headers.authorization.split(' ')[1];\n            \n            try {\n            payload=jwt.verify(token, process.env.JWTSECRETKEY);\n            \n            }catch (e) {\n            if (e.name === 'TokenExpiredError') {\n            res.status(401).send({message: \"Autorización expirada. Contacte con HospitalTenerife@sjd.es\"})\n            } else {\n            res.status(401).send({message: \"Autorización invalida\"})\n            }\n            return\n            }\n        if (!role || role === payload.role ) {\n            req.user = {\n                email: payload.sub,\n                role: payload.role\n            };\n            next();\n        } else {\n            res.status(401).send({message: 'No estas autorizado'});\n\n        }\n\n    }\n\n}\nmodule.exports = auth;\n"],"mappings":";;AACA,IAAIA,GAAG,GAAGC,OAAO,CAAC,cAAc,CAAC;AACjC,IAAIC,MAAM,GAAID,OAAO,CAAE,cAAc,CAAC;AAEtC,SAASE,IAAI,CAACC,IAAI,EAAE;EAEhB,OAAO,gBAAeC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IAElC,IAAIC,KAAK;IACT,IAAIC,OAAO;IAEX,IAAI,CAACJ,GAAG,CAACK,OAAO,CAACC,aAAa,EAAE;MAC5B,OAAOL,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAACC,OAAO,EAAE;MAAe,CAAC,CAAC;IACvD;IACAN,KAAK,GAACH,GAAG,CAACK,OAAO,CAACC,aAAa,CAACI,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAE7C,IAAI;MACJN,OAAO,GAACT,GAAG,CAACgB,MAAM,CAACR,KAAK,EAAES,OAAO,CAACC,GAAG,CAACC,YAAY,CAAC;IAEnD,CAAC,QAAOC,CAAC,EAAE;MACX,IAAIA,CAAC,CAACC,IAAI,KAAK,mBAAmB,EAAE;QACpCf,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAACC,OAAO,EAAE;QAA6D,CAAC,CAAC;MAC9F,CAAC,MAAM;QACPR,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAACC,OAAO,EAAE;QAAuB,CAAC,CAAC;MACxD;MACA;IACA;IACJ,IAAI,CAACV,IAAI,IAAIA,IAAI,KAAKK,OAAO,CAACL,IAAI,EAAG;MACjCC,GAAG,CAACiB,IAAI,GAAG;QACPC,KAAK,EAAEd,OAAO,CAACe,GAAG;QAClBpB,IAAI,EAAEK,OAAO,CAACL;MAClB,CAAC;MACDG,IAAI,EAAE;IACV,CAAC,MAAM;MACHD,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAACC,OAAO,EAAE;MAAqB,CAAC,CAAC;IAE1D;EAEJ,CAAC;AAEL;AACAW,MAAM,CAACC,OAAO,GAAGvB,IAAI"}},"mtime":1666005896919}}